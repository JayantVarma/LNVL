# The name of the '*.love' file for the engine.  Since LNVL is
# intended for use as a library we do not need to distribute this, but
# it is useful for testing purposes.
ENGINE = lnvl.love

# The source code for LNVL.  And the assets for testing.  Again, since
# we do not intend for developers to use the $(ENGINE) file directly,
# it is ok to include these assets.
SOURCES += *.lua
SOURCES += src/
SOURCES += examples/

# Create the $(ENGINE) file.
: $(SOURCES) \
|> ^ Building $(ENGINE)^ \
    zip --quiet --recurse-paths --compression-method store --update %o %f \
|> $(ENGINE)

# Create a TAGS file for use with GNU Emacs.  This also creates
# entries for opcode processor functions and the functions
# implementing each instruction.
: | TAGS \
|> ^ Creating TAGS^ ctags-exuberant -Re --languages=lua \
    --regex-lua="/Opcode\.Processor\[\"([a-z-]+)\"\]/Opcode.\1/" \
    --regex-lua="/LNVL\.Instructions\[\"([a-z-]+)\"\]/Instruction.\1/" \
|> TAGS
